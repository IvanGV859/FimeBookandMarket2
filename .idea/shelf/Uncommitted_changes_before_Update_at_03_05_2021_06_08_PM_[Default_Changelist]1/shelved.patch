Index: app/src/main/java/com/example/fimebookandmarket2/RegisterActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.fimebookandmarket2;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.app.ProgressDialog;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.text.TextUtils;\r\nimport android.view.View;\r\nimport android.widget.EditText;\r\nimport android.widget.Toast;\r\n\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\n\r\nimport java.util.HashMap;\r\n\r\npublic class RegisterActivity extends AppCompatActivity {\r\n\r\n    private EditText InputName, InputEmail, InputPassword, InputConfPassword, InputPhone;\r\n    private ProgressDialog loadingBar;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_register);\r\n\r\n        InputName = (EditText) findViewById(R.id.register_username_input);\r\n        InputEmail = (EditText) findViewById(R.id.register_email_input);\r\n        InputPassword = (EditText) findViewById(R.id.register_password_input);\r\n        InputConfPassword = (EditText) findViewById(R.id.register_confpassword_input);\r\n        InputPhone = (EditText) findViewById(R.id.register_phone_input);\r\n        loadingBar = new ProgressDialog(this);\r\n    }\r\n\r\n    public void onClick(View view){\r\n        switch (view.getId()){\r\n            case R.id.register_btn:\r\n                CreateAccount();\r\n                break;\r\n        }\r\n    }\r\n\r\n    private void CreateAccount() {\r\n        String name = InputName.getText().toString();\r\n        String email = InputEmail.getText().toString();\r\n        String password = InputPassword.getText().toString();\r\n        String confpassword = InputConfPassword.getText().toString();\r\n        String phone = InputPhone.getText().toString();\r\n\r\n        if(TextUtils.isEmpty(name)){\r\n            Toast.makeText(this, \"Escribe un nombre...\", Toast.LENGTH_SHORT).show();\r\n        } else if(TextUtils.isEmpty(email)){\r\n            Toast.makeText(this, \"Escribe un correo electronico...\", Toast.LENGTH_SHORT).show();\r\n        } else if(TextUtils.isEmpty(password)){\r\n            Toast.makeText(this, \"Escriba una contraseña...\", Toast.LENGTH_SHORT).show();\r\n        } else if(TextUtils.isEmpty(confpassword)){\r\n            Toast.makeText(this, \"Porfavor confirme su contraseña...\", Toast.LENGTH_SHORT).show();\r\n        } else if(TextUtils.isEmpty(phone)){\r\n            Toast.makeText(this, \"Agrege un numero de telefono.\", Toast.LENGTH_SHORT).show();\r\n        } else if(password.length() < 6) {\r\n            Toast.makeText(this, \"La contraseña debe tener más de 6 caracteres.\", Toast.LENGTH_SHORT).show();\r\n        } else if(name.length() < 5){\r\n            Toast.makeText(this, \"El nombre de usuario debe tener mas de 5 caracteres.\", Toast.LENGTH_SHORT).show();\r\n        } else if(!password.equals(confpassword)){\r\n            Toast.makeText(this, \"Las contraseñas no coinciden.\", Toast.LENGTH_SHORT).show();\r\n        } else {\r\n            loadingBar.setTitle(\"Creando cuenta\");\r\n            loadingBar.setMessage(\"Porfavor espere, mientras validamos sus credenciales.\");\r\n            loadingBar.setCanceledOnTouchOutside(false);\r\n            loadingBar.show();\r\n\r\n            ValidatephoneNumber(name, email, password, phone);\r\n        }\r\n    }\r\n\r\n    private void ValidatephoneNumber(final String name, final String email, final String password, final String phone) {\r\n        final DatabaseReference RootRef;\r\n        RootRef = FirebaseDatabase.getInstance().getReference();\r\n\r\n        RootRef.addListenerForSingleValueEvent(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot dataSnapshot) {\r\n                if(!(dataSnapshot.child(\"Users\").child(phone).exists())){\r\n\r\n                    HashMap<String, Object> userdataMap = new HashMap<>();\r\n                    userdataMap.put(\"name\", name);\r\n                    userdataMap.put(\"email\", email);\r\n                    userdataMap.put(\"password\", password);\r\n                    userdataMap.put(\"phone\", phone);\r\n\r\n                    RootRef.child(\"users\").child(phone).updateChildren(userdataMap)\r\n                            .addOnCompleteListener(new OnCompleteListener<Void>() {\r\n                                @Override\r\n                                public void onComplete(@NonNull Task<Void> task) {\r\n                                    if(task.isSuccessful()){\r\n                                        Toast.makeText(RegisterActivity.this, \"Cuenta creada correctamente\", Toast.LENGTH_SHORT).show();\r\n                                        loadingBar.dismiss();\r\n                                        Intent intent = new Intent(RegisterActivity.this, LoginActivity.class);\r\n                                        startActivity(intent);\r\n                                    } else {\r\n                                        loadingBar.dismiss();\r\n                                        Toast.makeText(RegisterActivity.this, \"Error de conexión: Porfavor intente en un rato...\", Toast.LENGTH_SHORT).show();\r\n                                    }\r\n                                }\r\n                            });\r\n                } else {\r\n                    Toast.makeText(RegisterActivity.this, \"El telefono \" + phone + \" ya existe.\", Toast.LENGTH_SHORT).show();\r\n                    loadingBar.dismiss();\r\n                    Toast.makeText(RegisterActivity.this, \"Intente con otro numero de telefono.\", Toast.LENGTH_SHORT).show();\r\n                    Intent intent = new Intent(RegisterActivity.this, MainActivity.class);\r\n                    startActivity(intent);\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/fimebookandmarket2/RegisterActivity.java	(revision abbdc9a10782a62c1db641f365600ceb32bf64b9)
+++ app/src/main/java/com/example/fimebookandmarket2/RegisterActivity.java	(date 1619225186215)
@@ -87,7 +87,13 @@
         RootRef.addListenerForSingleValueEvent(new ValueEventListener() {
             @Override
             public void onDataChange(@NonNull DataSnapshot dataSnapshot) {
-                if(!(dataSnapshot.child("Users").child(phone).exists())){
+                if (dataSnapshot.child("users").child(phone).exists()) {
+                    Toast.makeText(RegisterActivity.this, "El telefono " + phone + " ya existe.", Toast.LENGTH_SHORT).show();
+                    loadingBar.dismiss();
+                    Toast.makeText(RegisterActivity.this, "Intente con otro numero de telefono.", Toast.LENGTH_SHORT).show();
+                    Intent intent = new Intent(RegisterActivity.this, MainActivity.class);
+                    startActivity(intent);
+                } else {
 
                     HashMap<String, Object> userdataMap = new HashMap<>();
                     userdataMap.put("name", name);
@@ -110,18 +116,12 @@
                                     }
                                 }
                             });
-                } else {
-                    Toast.makeText(RegisterActivity.this, "El telefono " + phone + " ya existe.", Toast.LENGTH_SHORT).show();
-                    loadingBar.dismiss();
-                    Toast.makeText(RegisterActivity.this, "Intente con otro numero de telefono.", Toast.LENGTH_SHORT).show();
-                    Intent intent = new Intent(RegisterActivity.this, MainActivity.class);
-                    startActivity(intent);
                 }
             }
 
             @Override
             public void onCancelled(@NonNull DatabaseError error) {
-
+                Toast.makeText(RegisterActivity.this, "Error", Toast.LENGTH_SHORT).show();
             }
         });
     }
